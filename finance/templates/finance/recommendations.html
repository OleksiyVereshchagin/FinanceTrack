{##}
{#{% extends 'main/layout.html' %}#}
{#{% load static %}#}
{##}
{#{% block extra_css %}#}
{#<link rel="stylesheet" href="{% static 'finance/css/expense_analysis.css' %}">#}
{#{% endblock %}#}
{##}
{#{% block content %}#}
{#<div class="container" id="content">#}
{#  <h1>–§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó üí∞</h1>#}
{#  <div class="nav-buttons">#}
{#    <a href="#analysis">–ê–Ω–∞–ª—ñ–∑</a>#}
{#    <a href="#goals">–¶—ñ–ª—ñ</a>#}
{#    <a href="#settings">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</a>#}
{#  </div>#}
{##}
{#  <!-- –û—Å–Ω–æ–≤–Ω–∞ –ø–æ—Ä–∞–¥–∞ -->#}
{#  <div class="highlight-card">#}
{#    <h2>üîç –ì–æ–ª–æ–≤–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫</h2>#}
{#    {% if trend_data %}#}
{#      <p>{{ trend_data.0.insight }}</p>#}
{#    {% else %}#}
{#      <p>–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–∞–Ω–∏—Ö –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É. –î–æ–¥–∞–π—Ç–µ –±—ñ–ª—å—à–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.</p>#}
{#    {% endif %}#}
{#  </div>#}
{##}
{#  <!-- –ì—Ä–∞—Ñ—ñ–∫–∏ —Ç—Ä–µ–Ω–¥—ñ–≤ -->#}
{#  <div class="trends-section" id="analysis">#}
{#    <h3>üìà –î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Ç—Ä–µ–Ω–¥—ñ–≤</h3>#}
{#    {% for item in trend_data %}#}
{#    <div class="trend-card">#}
{#      <h4>{{ item.category }}</h4>#}
{#      <div class="trend-chart">#}
{#        <h5>–¢—Ä–µ–Ω–¥ –≤–∏—Ç—Ä–∞—Ç –Ω–∞ {{ item.category }}</h5>#}
{#        <canvas id="chart-{{ forloop.counter }}"></canvas>#}
{#      </div>#}
{#      <div class="trend-details">#}
{#        <table>#}
{#          <tr><th>–û—Å—Ç–∞–Ω–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:</th><td style="color: #28a745;">{% for val in item.values %}{{ val|floatformat:2 }}{{ item.currency }}{% if not forloop.last %}, {% endif %}{% endfor %}</td></tr>#}
{#          <tr><th>–ü—Ä–æ–≥–Ω–æ–∑:</th><td style="color: #28a745;">{{ item.forecast|floatformat:2 }}{{ item.currency }}</td></tr>#}
{#        </table>#}
{#        <p class="insight">{{ item.insight }}</p>#}
{#      </div>#}
{#    </div>#}
{#    {% empty %}#}
{#    <p>–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –ø–æ–º—ñ—Ç–Ω–∏—Ö —Ç—Ä–µ–Ω–¥—ñ–≤ —É –≤–∞—à–∏—Ö –≤–∏—Ç—Ä–∞—Ç–∞—Ö.</p>#}
{#    {% endfor %}#}
{#  </div>#}
{##}
{#  <!-- –¶—ñ–ª—ñ -->#}
{#  <div class="goals-section" id="goals">#}
{#    <h3>üéØ –í–∞—à—ñ —Ü—ñ–ª—ñ</h3>#}
{#    {% include 'finance/goals_list.html' %}#}
{#  </div>#}
{##}
{#  <button onclick="exportToPDF()">–ï–∫—Å–ø–æ—Ä—Ç —É PDF</button>#}
{#</div>#}
{##}
{#<!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è JavaScript –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ -->#}
{#<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>#}
{#<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>#}
{#<script>#}
{#  document.addEventListener('DOMContentLoaded', function() {#}
{#    {% for item in trend_data %}#}
{#    new Chart(document.getElementById('chart-{{ forloop.counter }}'), {#}
{#      type: 'line',#}
{#      data: {#}
{#        labels: {{ item.months|join:", "|safe }},#}
{#        datasets: [{#}
{#          label: '–§–∞–∫—Ç–∏—á–Ω—ñ',#}
{#          data: {{ item.values|join:", " }},#}
{#          borderColor: 'rgb(75, 192, 192)',#}
{#          tension: 0.1#}
{#        }, {#}
{#          label: '–ü—Ä–æ–≥–Ω–æ–∑',#}
{#          data: [{{ item.values|last }}, {{ item.forecast }}],#}
{#          borderColor: 'rgb(255, 99, 132)',#}
{#          borderDash: [5, 5],#}
{#          tension: 0.1#}
{#        }]#}
{#      },#}
{#      options: {#}
{#        responsive: true,#}
{#        maintainAspectRatio: false#}
{#      }#}
{#    });#}
{#    {% endfor %}#}
{#  });#}
{##}
{#  function exportToPDF() {#}
{#    const element = document.getElementById('content');#}
{#    html2pdf().from(element).save('financial_recommendations.pdf');#}
{#  }#}
{#</script>#}
{#{% endblock %}#}



























{##}
{##}
{#{% extends 'main/layout.html' %}#}
{#{% load static %}#}
{##}
{#{% block extra_css %}#}
{#<link rel="stylesheet" href="{% static 'finance/css/expense_analysis.css' %}">#}
{#{% endblock %}#}
{##}
{#{% block content %}#}
{#<div class="container" id="content">#}
{#  <h1>–§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó üí∞</h1>#}
{##}
{#  <!-- –û—Å–Ω–æ–≤–Ω–∞ –ø–æ—Ä–∞–¥–∞ -->#}
{#  <div class="highlight-card">#}
{#    <h2>üîç –ì–æ–ª–æ–≤–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫</h2>#}
{#    {% if trend_data %}#}
{#      <p>{{ trend_data.0.insight }}</p>#}
{#    {% else %}#}
{#      <p>–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–∞–Ω–∏—Ö –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É. –î–æ–¥–∞–π—Ç–µ –±—ñ–ª—å—à–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.</p>#}
{#    {% endif %}#}
{#  </div>#}
{##}
{#  <!-- –ì—Ä–∞—Ñ—ñ–∫–∏ —Ç—Ä–µ–Ω–¥—ñ–≤ -->#}
{#  <div class="trends-section" id="analysis">#}
{#    <h3>üìà –î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Ç—Ä–µ–Ω–¥—ñ–≤</h3>#}
{#    {% for item in trend_data %}#}
{#    <div class="trend-card">#}
{#      <h4>{{ item.category }}</h4>#}
{#      <div class="trend-chart">#}
{#        <h5>–¢—Ä–µ–Ω–¥ –≤–∏—Ç—Ä–∞—Ç –Ω–∞ {{ item.category }}</h5>#}
{#        <canvas id="chart-{{ forloop.counter }}"></canvas>#}
{#      </div>#}
{#      <div class="trend-details">#}
{#        <table>#}
{#          <tr><th>–û—Å—Ç–∞–Ω–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:</th><td style="color: #28a745;">{% for val in item.values %}{{ val|floatformat:2 }}{{ item.currency }}{% if not forloop.last %}, {% endif %}{% endfor %}</td></tr>#}
{#          <tr><th>–ü—Ä–æ–≥–Ω–æ–∑:</th><td style="color: #28a745;">{{ item.forecast|floatformat:2 }}{{ item.currency }}</td></tr>#}
{#        </table>#}
{#        <p class="insight">{{ item.insight }}</p>#}
{#      </div>#}
{#    </div>#}
{#    {% empty %}#}
{#    <p>–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –ø–æ–º—ñ—Ç–Ω–∏—Ö —Ç—Ä–µ–Ω–¥—ñ–≤ —É –≤–∞—à–∏—Ö –≤–∏—Ç—Ä–∞—Ç–∞—Ö.</p>#}
{#    {% endfor %}#}
{#  </div>#}
{##}
{#  <!-- –¶—ñ–ª—ñ -->#}
{#  <div class="goals-section" id="goals">#}
{#    <h3>üéØ –í–∞—à—ñ —Ü—ñ–ª—ñ</h3>#}
{#    {% include 'finance/goals_list.html' %}#}
{#  </div>#}
{#</div>#}
{##}
{#<!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è JavaScript –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ -->#}
{#<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>#}
{#<script>#}
{#  document.addEventListener('DOMContentLoaded', function() {#}
{#    {% for item in trend_data %}#}
{#    new Chart(document.getElementById('chart-{{ forloop.counter }}'), {#}
{#      type: 'line',#}
{#      data: {#}
{#        labels: {{ item.months|join:", "|safe }},#}
{#        datasets: [{#}
{#          label: '–§–∞–∫—Ç–∏—á–Ω—ñ',#}
{#          data: {{ item.values|join:", " }},#}
{#          borderColor: 'rgb(75, 192, 192)',#}
{#          tension: 0.1#}
{#        }, {#}
{#          label: '–ü—Ä–æ–≥–Ω–æ–∑',#}
{#          data: [{{ item.values|slice:"-1:"|join:", " }}, {{ item.forecast }}],#}
{#          borderColor: 'rgb(255, 99, 132)',#}
{#          borderDash: [5, 5],#}
{#          tension: 0.1#}
{#        }]#}
{#      },#}
{#      options: {#}
{#        responsive: true,#}
{#        maintainAspectRatio: false#}
{#      }#}
{#    });#}
{#    {% endfor %}#}
{#  });#}
{#</script>#}
{#{% endblock %}#}



{#{% extends 'main/layout.html' %}#}
{#{% load static %}#}
{##}
{#{% block extra_css %}#}
{#<link rel="stylesheet" href="{% static 'finance/css/expense_analysis.css' %}">#}
{#<style>#}
{#  .trend-chart canvas {#}
{#    width: 100%;#}
{#    height: 200px;#}
{#    background-color: #f9f9f9; /* –§–æ–Ω –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç—ñ */#}
{#  }#}
{#</style>#}
{#{% endblock %}#}
{##}
{#{% block content %}#}
{#<div class="container" id="content">#}
{#  <h1>–§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó üí∞</h1>#}
{##}
{#  <!-- –û—Å–Ω–æ–≤–Ω–∞ –ø–æ—Ä–∞–¥–∞ -->#}
{#  <div class="highlight-card">#}
{#    <h2>üîç –ì–æ–ª–æ–≤–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫</h2>#}
{#    {% if trend_data %}#}
{#      <p>{{ trend_data.0.insight }}</p>#}
{#    {% else %}#}
{#      <p>–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–∞–Ω–∏—Ö –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É. –î–æ–¥–∞–π—Ç–µ –±—ñ–ª—å—à–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.</p>#}
{#    {% endif %}#}
{#  </div>#}
{##}
{#  <!-- –ì—Ä–∞—Ñ—ñ–∫–∏ —Ç—Ä–µ–Ω–¥—ñ–≤ -->#}
{#  <div class="trends-section" id="analysis">#}
{#    <h3>üìà –î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Ç—Ä–µ–Ω–¥—ñ–≤</h3>#}
{#    {% for item in trend_data %}#}
{#    <div class="trend-card">#}
{#      <h4>{{ item.category }}</h4>#}
{#      <div class="trend-chart">#}
{#        <h5>–¢—Ä–µ–Ω–¥ –≤–∏—Ç—Ä–∞—Ç –Ω–∞ {{ item.category }}</h5>#}
{#        <canvas id="chart-{{ forloop.counter }}"></canvas>#}
{#      </div>#}
{#      <div class="trend-details">#}
{#        <table>#}
{#          <tr><th>–û—Å—Ç–∞–Ω–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:</th><td style="color: #28a745;">{% for val in item.values %}{{ val|floatformat:2 }}{{ item.currency }}{% if not forloop.last %}, {% endif %}{% endfor %}</td></tr>#}
{#          <tr><th>–ü—Ä–æ–≥–Ω–æ–∑:</th><td style="color: #28a745;">{{ item.forecast|floatformat:2 }}{{ item.currency }}</td></tr>#}
{#        </table>#}
{#        <p class="insight">{{ item.insight }}</p>#}
{#      </div>#}
{#    </div>#}
{#    {% empty %}#}
{#    <p>–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –ø–æ–º—ñ—Ç–Ω–∏—Ö —Ç—Ä–µ–Ω–¥—ñ–≤ —É –≤–∞—à–∏—Ö –≤–∏—Ç—Ä–∞—Ç–∞—Ö.</p>#}
{#    {% endfor %}#}
{#  </div>#}
{##}
{#  <!-- –¶—ñ–ª—ñ -->#}
{#  <div class="goals-section" id="goals">#}
{#    <h3>üéØ –í–∞—à—ñ —Ü—ñ–ª—ñ</h3>#}
{#    {% include 'finance/goals_list.html' %}#}
{#  </div>#}
{#</div>#}
{##}
{#<!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è JavaScript –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ -->#}
{#<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>#}
{#<script>#}
{#  document.addEventListener('DOMContentLoaded', function() {#}
{#    {% for item in trend_data %}#}
{#    try {#}
{#      new Chart(document.getElementById('chart-{{ forloop.counter }}'), {#}
{#        type: 'line',#}
{#        data: {#}
{#          labels: {{ item.months|join:", "|safe }},#}
{#          datasets: [{#}
{#            label: '–§–∞–∫—Ç–∏—á–Ω—ñ',#}
{#            data: {{ item.values|join:", " }},#}
{#            borderColor: 'rgb(75, 192, 192)',#}
{#            tension: 0.1#}
{#          }, {#}
{#            label: '–ü—Ä–æ–≥–Ω–æ–∑',#}
{#            data: [{% if item.values %}{{ item.values|slice:"-1:"|join:", " }}{% else %}0{% endif %}, {{ item.forecast }}],#}
{#            borderColor: 'rgb(255, 99, 132)',#}
{#            borderDash: [5, 5],#}
{#            tension: 0.1#}
{#          }]#}
{#        },#}
{#        options: {#}
{#          responsive: true,#}
{#          maintainAspectRatio: false,#}
{#          scales: {#}
{#            y: {#}
{#              beginAtZero: true#}
{#            }#}
{#          }#}
{#        }#}
{#      });#}
{#    } catch (error) {#}
{#      console.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –≥—Ä–∞—Ñ—ñ–∫–∞ –¥–ª—è {{ item.category }}:', error);#}
{#    }#}
{#    {% endfor %}#}
{#  });#}
{#</script>#}
{#{% endblock %}#}





{#--------------------------------------------------------------------------------#}








{##}
{##}
{#{% extends 'main/layout.html' %}#}
{#{% load static %}#}
{##}
{#{% block extra_css %}#}
{#<link rel="stylesheet" href="{% static 'finance/css/expense_analysis.css' %}">#}
{#{% endblock %}#}
{##}
{#{% block content %}#}
{#<div class="container" id="content">#}
{#  <h1>–§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó üí∞</h1>#}
{##}
{#  <!-- –û—Å–Ω–æ–≤–Ω–∞ –ø–æ—Ä–∞–¥–∞ -->#}
{#  <div class="highlight-card">#}
{#    <h2>üîç –ì–æ–ª–æ–≤–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫</h2>#}
{#    {% if trend_data %}#}
{#      <p>{{ trend_data.0.insight }}</p>#}
{#    {% else %}#}
{#      <p>–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–∞–Ω–∏—Ö –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É. –î–æ–¥–∞–π—Ç–µ –±—ñ–ª—å—à–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.</p>#}
{#    {% endif %}#}
{#  </div>#}
{##}
{#  <!-- –ì—Ä–∞—Ñ—ñ–∫–∏ —Ç—Ä–µ–Ω–¥—ñ–≤ -->#}
{#  <div class="trends-section" id="analysis">#}
{#    <h3>üìà –î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Ç—Ä–µ–Ω–¥—ñ–≤</h3>#}
{#    {% for item in trend_data %}#}
{#    <div class="trend-card">#}
{#      <h4>{{ item.category }}</h4>#}
{#      <div class="trend-chart">#}
{#        <h5>–¢—Ä–µ–Ω–¥ –≤–∏—Ç—Ä–∞—Ç –Ω–∞ {{ item.category }}</h5>#}
{#        <canvas id="chart-{{ forloop.counter }}"></canvas>#}
{#      </div>#}
{#      <div class="trend-details">#}
{#        <table>#}
{#          <tr><th>–û—Å—Ç–∞–Ω–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:</th><td style="color: #28a745;">{% for val in item.values %}{{ val|floatformat:2 }}{{ item.currency }}{% if not forloop.last %}, {% endif %}{% endfor %}</td></tr>#}
{#          <tr><th>–ü—Ä–æ–≥–Ω–æ–∑:</th><td style="color: #28a745;">{{ item.forecast|floatformat:2 }}{{ item.currency }}</td></tr>#}
{#        </table>#}
{#        <p class="insight">{{ item.insight }}</p>#}
{#      </div>#}
{#    </div>#}
{#    {% empty %}#}
{#    <p>–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –ø–æ–º—ñ—Ç–Ω–∏—Ö —Ç—Ä–µ–Ω–¥—ñ–≤ —É –≤–∞—à–∏—Ö –≤–∏—Ç—Ä–∞—Ç–∞—Ö.</p>#}
{#    {% endfor %}#}
{#  </div>#}
{##}
{#  <!-- –¶—ñ–ª—ñ -->#}
{#  <div class="goals-section" id="goals">#}
{#    <h3>üéØ –í–∞—à—ñ —Ü—ñ–ª—ñ</h3>#}
{#    {% include 'finance/goals_list.html' %}#}
{#  </div>#}
{#</div>#}
{##}
{#<!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è JavaScript –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ -->#}
{#<script src="{% static 'finance/js/chart.umd.min.js' %}"></script>#}
{#<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>#}
{##}
{##}
{#<script>#}
{#document.addEventListener('DOMContentLoaded', function() {#}
{#    console.log('–°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω–æ, –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ Chart.js...');#}
{##}
{#    if (typeof Chart === 'undefined') {#}
{#        console.error('Chart.js –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!');#}
{#        return;#}
{#    }#}
{##}
{#    {% for item in trend_data %}#}
{#    try {#}
{#        console.log('–û–±—Ä–æ–±–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó: {{ item.category }}');#}
{#        const ctx = document.getElementById('chart-{{ forloop.counter }}');#}
{#        if (!ctx) {#}
{#            console.error('Canvas –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –¥–ª—è {{ item.category }}!');#}
{#            return;#}
{#        }#}
{##}
{#        // –ë–µ–∑–ø–µ—á–Ω–∏–π –ø–∞—Ä—Å–∏–Ω–≥ JSON –¥–∞–Ω–∏—Ö#}
{#        const allLabels = JSON.parse('{{ item.months_json|escapejs|default:"[]" }}');#}
{#        const allValues = JSON.parse('{{ item.values_json|escapejs|default:"[]" }}');#}
{#        const forecast = parseFloat('{{ item.forecast|escapejs|default:"0" }}') || 0;#}
{##}
{#        // –ë–µ—Ä–µ–º–æ —Ç—ñ–ª—å–∫–∏ 3 –æ—Å—Ç–∞–Ω–Ω—ñ –º—ñ—Å—è—Ü—ñ#}
{#        const last3Labels = allLabels.slice(-3);#}
{#        const last3Values = allValues.slice(-3);#}
{#        const lastValue = last3Values.length > 0 ? last3Values[last3Values.length - 1] : 0;#}
{##}
{#        // –î–æ–¥–∞—î–º–æ –ø—Ä–æ–≥–Ω–æ–∑#}
{#        const displayLabels = [...last3Labels, '–ü—Ä–æ–≥–Ω–æ–∑'];#}
{#        const displayValues = [...last3Values, null]; // –§–∞–∫—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ#}
{#        const forecastValues = [...Array(last3Values.length - 1).fill(null), lastValue, forecast]; // –ü—Ä–æ–≥–Ω–æ–∑#}
{##}
{#        console.log('–î–∞–Ω—ñ –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫–∞:', {#}
{#            labels: displayLabels,#}
{#            values: displayValues,#}
{#            forecast: forecastValues#}
{#        });#}
{##}
{#        new Chart(ctx, {#}
{#            type: 'line',#}
{#            data: {#}
{#                labels: displayLabels,#}
{#                datasets: [#}
{#                    {#}
{#                        label: '–§–∞–∫—Ç–∏—á–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏',#}
{#                        data: displayValues,#}
{#                        borderColor: 'rgb(75, 192, 192)',#}
{#                        backgroundColor: 'rgba(75, 192, 192, 0.1)',#}
{#                        borderWidth: 2,#}
{#                        tension: 0.3,#}
{#                        fill: false,#}
{#                        pointBackgroundColor: 'rgb(75, 192, 192)',#}
{#                        pointRadius: 4#}
{#                    },#}
{#                    {#}
{#                        label: '–ü—Ä–æ–≥–Ω–æ–∑',#}
{#                        data: forecastValues,#}
{#                        borderColor: 'rgb(255, 99, 132)',#}
{#                        borderWidth: 2,#}
{#                        borderDash: [5, 3],#}
{#                        tension: 0,#}
{#                        pointBackgroundColor: 'rgb(255, 99, 132)',#}
{#                        pointRadius: 5,#}
{#                        fill: false#}
{#                    }#}
{#                ]#}
{#            },#}
{#            options: {#}
{#                responsive: true,#}
{#                maintainAspectRatio: false,#}
{#                plugins: {#}
{#                    legend: {#}
{#                        position: 'top',#}
{#                        labels: {#}
{#                            boxWidth: 12,#}
{#                            padding: 20,#}
{#                            usePointStyle: true#}
{#                        }#}
{#                    },#}
{#                    tooltip: {#}
{#                        mode: 'index',#}
{#                        intersect: false,#}
{#                        callbacks: {#}
{#                            label: function(context) {#}
{#                                return context.dataset.label + ': ' + context.raw + ' {{ item.currency }}';#}
{#                            }#}
{#                        }#}
{#                    }#}
{#                },#}
{#                scales: {#}
{#                    y: {#}
{#                        beginAtZero: true,#}
{#                        grid: {#}
{#                            drawBorder: false#}
{#                        },#}
{#                        title: {#}
{#                            display: true,#}
{#                            text: '–°—É–º–∞ ({{ item.currency }})'#}
{#                        }#}
{#                    },#}
{#                    x: {#}
{#                        grid: {#}
{#                            display: false#}
{#                        },#}
{#                        ticks: {#}
{#                            autoSkip: false,#}
{#                            maxRotation: 0#}
{#                        }#}
{#                    }#}
{#                },#}
{#                elements: {#}
{#                    line: {#}
{#                        cubicInterpolationMode: 'monotone'#}
{#                    }#}
{#                }#}
{#            }#}
{#        });#}
{#        console.log('–ì—Ä–∞—Ñ—ñ–∫ –¥–ª—è {{ item.category }} —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ.');#}
{#    } catch (error) {#}
{#        console.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –≥—Ä–∞—Ñ—ñ–∫–∞ –¥–ª—è {{ item.category }}:', error);#}
{#    }#}
{#    {% endfor %}#}
{#});#}
{#</script>#}
{##}
{##}
{##}
{#});#}
{#</script>#}
{#{% endblock %}#}


{#---------------------------------------------------------------------------------------------------#}
{##}
{#{% extends 'main/layout.html' %}#}
{#{% load static %}#}
{##}
{#{% block extra_css %}#}
{#<link rel="stylesheet" href="{% static 'finance/css/expense_analysis.css' %}">#}
{#<style>#}
{#    /* –û—Å–Ω–æ–≤–Ω—ñ —Å—Ç–∏–ª—ñ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç—É */#}
{#    .finance-content {#}
{#        padding: 20px;#}
{#        max-width: 1000px;#}
{#        margin: 0 auto;#}
{#        font-family: 'Inter', sans-serif;#}
{#    }#}
{##}
{#    /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ */#}
{#    .finance-title {#}
{#        font-size: 24px;#}
{#        font-weight: 600;#}
{#        color: #2d3748;#}
{#        margin-bottom: 20px;#}
{#        padding-bottom: 10px;#}
{#        border-bottom: 1px solid #e2e8f0;#}
{#    }#}
{##}
{#    .section-title {#}
{#        font-size: 20px;#}
{#        font-weight: 600;#}
{#        color: #2d3748;#}
{#        margin: 25px 0 15px;#}
{#    }#}
{##}
{#    /* –ö–∞—Ä—Ç–∫–∞ –∑ –≤–∏—Å–Ω–æ–≤–∫–æ–º */#}
{#    .summary-card {#}
{#        background: #f8fafc;#}
{#        border-left: 4px solid #c1e6cb;#}
{#        padding: 15px;#}
{#        border-radius: 0 8px 8px 0;#}
{#        margin-bottom: 25px;#}
{#    }#}
{##}
{#    /* –°—Ç–∏–ª—ñ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π */#}
{#    .category-card {#}
{#        background: white;#}
{#        border-radius: 8px;#}
{#        padding: 0;#}
{#        margin-bottom: 25px;#}
{#        box-shadow: 0 2px 4px rgba(0,0,0,0.05);#}
{#        border: 1px solid #edf2f7;#}
{#    }#}
{##}
{#    .category-header {#}
{#        padding: 15px;#}
{#        border-bottom: 1px solid #edf2f7;#}
{#        font-weight: 600;#}
{#        color: #2d3748;#}
{#    }#}
{##}
{#    .category-content {#}
{#        display: flex;#}
{#        padding: 15px;#}
{#    }#}
{##}
{#    @media (max-width: 768px) {#}
{#        .category-content {#}
{#            flex-direction: column;#}
{#        }#}
{#    }#}
{##}
{#    /* –ì—Ä–∞—Ñ—ñ–∫ */#}
{#    .chart-container {#}
{#        flex: 2;#}
{#        min-height: 200px;#}
{#        position: relative;#}
{#    }#}
{##}
{#    /* –¢–∞–±–ª–∏—Ü—è –∑ –¥–∞–Ω–∏–º–∏ */#}
{#    .data-table {#}
{#        flex: 1;#}
{#        margin-left: 20px;#}
{#    }#}
{##}
{#    .data-table table {#}
{#        width: 100%;#}
{#        border-collapse: collapse;#}
{#    }#}
{##}
{#    .data-table th, .data-table td {#}
{#        padding: 8px 12px;#}
{#        text-align: left;#}
{#        border-bottom: 1px solid #edf2f7;#}
{#    }#}
{##}
{#    .data-table th {#}
{#        font-weight: 500;#}
{#        color: #4a5568;#}
{#        white-space: nowrap;#}
{#    }#}
{##}
{#    /* –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó */#}
{#    .recommendation {#}
{#        padding: 15px;#}
{#        background: #f8fafc;#}
{#        border-top: 1px solid #edf2f7;#}
{#        font-size: 14px;#}
{#        color: #4a5568;#}
{#    }#}
{##}
{#    /* –§—É—Ç–µ—Ä */#}
{#    .finance-footer {#}
{#        margin-top: 40px;#}
{#        padding-top: 20px;#}
{#        border-top: 1px solid #e2e8f0;#}
{#        text-align: center;#}
{#        color: #718096;#}
{#        font-size: 14px;#}
{#    }#}
{#</style>#}
{#{% endblock %}#}
{##}
{#{% block content %}#}
{#<div class="finance-content">#}
{#    <h1 class="finance-title">–ê–Ω–∞–ª—ñ–∑ –≤–∏—Ç—Ä–∞—Ç —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</h1>#}
{##}
{#    <!-- –ö–ª—é—á–æ–≤–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫ -->#}
{#    <div class="summary-card">#}
{#        <h3 class="section-title">–ö–ª—é—á–æ–≤–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫</h3>#}
{#        {% if trend_data %}#}
{#            <p>{{ trend_data.0.insight }}</p>#}
{#        {% else %}#}
{#            <p>–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–∞–Ω–∏—Ö –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É. –î–æ–¥–∞–π—Ç–µ –±—ñ–ª—å—à–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.</p>#}
{#        {% endif %}#}
{#    </div>#}
{##}
{#    <!-- –¢—Ä–µ–Ω–¥–∏ –≤–∏—Ç—Ä–∞—Ç -->#}
{#    <h3 class="section-title">–¢—Ä–µ–Ω–¥–∏ –≤–∏—Ç—Ä–∞—Ç –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏</h3>#}
{##}
{#    {% for item in trend_data %}#}
{#    <div class="category-card">#}
{#        <div class="category-header">{{ item.category }}</div>#}
{##}
{#        <div class="category-content">#}
{#            <div class="chart-container">#}
{#                <canvas id="chart-{{ forloop.counter }}"></canvas>#}
{#            </div>#}
{##}
{#            <div class="data-table">#}
{#                <table>#}
{#                    <tr>#}
{#                        <th>–û—Å—Ç–∞–Ω–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:</th>#}
{#                        <td>#}
{#                            {% with last_values=item.values|slice:"-3:" %}#}
{#                                {% for val in last_values %}#}
{#                                    {{ val|floatformat:2 }}{{ item.currency }}#}
{#                                    {% if not forloop.last %}, {% endif %}#}
{#                                {% endfor %}#}
{#                            {% endwith %}#}
{#                        </td>#}
{#                    </tr>#}
{#                    <tr>#}
{#                        <th>–ü—Ä–æ–≥–Ω–æ–∑:</th>#}
{#                        <td>{{ item.forecast|floatformat:2 }}{{ item.currency }}</td>#}
{#                    </tr>#}
{#                </table>#}
{#            </div>#}
{#        </div>#}
{##}
{#        <div class="recommendation">#}
{#            <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:</strong> {{ item.insight }}#}
{#        </div>#}
{#    </div>#}
{#    {% empty %}#}
{#    <p>–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –ø–æ–º—ñ—Ç–Ω–∏—Ö —Ç—Ä–µ–Ω–¥—ñ–≤ —É –≤–∞—à–∏—Ö –≤–∏—Ç—Ä–∞—Ç–∞—Ö.</p>#}
{#    {% endfor %}#}
{##}
{#    <div class="finance-footer">#}
{#        ¬© 2025 FinanceTrack#}
{#    </div>#}
{#</div>#}
{##}
{#<!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è Chart.js -->#}
{#<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>#}
{#<script>#}
{#document.addEventListener('DOMContentLoaded', function() {#}
{#    {% for item in trend_data %}#}
{#    try {#}
{#        const ctx = document.getElementById('chart-{{ forloop.counter }}');#}
{#        if (!ctx) return;#}
{##}
{#        const labels = JSON.parse('{{ item.months_json|escapejs }}');#}
{#        const values = JSON.parse('{{ item.values_json|escapejs }}');#}
{#        const currency = '{{ item.currency }}';#}
{##}
{#        new Chart(ctx, {#}
{#            type: 'line',#}
{#            data: {#}
{#                labels: labels,#}
{#                datasets: [{#}
{#                    label: '–í–∏—Ç—Ä–∞—Ç–∏ (' + currency + ')',#}
{#                    data: values,#}
{#                    borderColor: '#3182ce',#}
{#                    backgroundColor: 'rgba(49, 130, 206, 0.1)',#}
{#                    borderWidth: 2,#}
{#                    tension: 0.3,#}
{#                    fill: true,#}
{#                    pointBackgroundColor: '#3182ce',#}
{#                    pointRadius: 4,#}
{#                    pointHoverRadius: 6#}
{#                }]#}
{#            },#}
{#            options: {#}
{#                responsive: true,#}
{#                maintainAspectRatio: false,#}
{#                plugins: {#}
{#                    legend: {#}
{#                        display: false#}
{#                    }#}
{#                },#}
{#                scales: {#}
{#                    y: {#}
{#                        beginAtZero: true,#}
{#                        grid: {#}
{#                            drawBorder: false#}
{#                        }#}
{#                    },#}
{#                    x: {#}
{#                        grid: {#}
{#                            display: false#}
{#                        }#}
{#                    }#}
{#                }#}
{#            }#}
{#        });#}
{#    } catch (error) {#}
{#        console.error('Error creating chart:', error);#}
{#    }#}
{#    {% endfor %}#}
{#});#}
{#</script>#}
{#{% endblock %}#}






{##}
{#{% extends 'main/layout.html' %}#}
{#{% load static %}#}
{##}
{#{% block content %}#}
{#<div class="finance-content">#}
{#    <h1 class="finance-title">–ê–Ω–∞–ª—ñ–∑ –≤–∏—Ç—Ä–∞—Ç —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</h1>#}
{##}
{#    <!-- –¢—Ä–µ–Ω–¥–∏ –≤–∏—Ç—Ä–∞—Ç -->#}
{#    <h3 class="section-title">–¢—Ä–µ–Ω–¥–∏ –≤–∏—Ç—Ä–∞—Ç –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏</h3>#}
{##}
{#    {% for item in trend_data %}#}
{#    <div class="category-card">#}
{#        <div class="category-header">#}
{#            {{ item.category }}#}
{#            <span class="currency-badge">{{ item.currency }}</span>#}
{#        </div>#}
{##}
{#        <div class="category-content">#}
{#            <div class="chart-container">#}
{#                <canvas id="chart-{{ forloop.counter }}"></canvas>#}
{#            </div>#}
{##}
{#            <div class="data-table">#}
{#                <table>#}
{#                    <tr>#}
{#                        <th>–û—Å—Ç–∞–Ω–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:</th>#}
{#                        <td>#}
{#                            {% with last_values=item.values|slice:"-3:" %}#}
{#                                {% for val in last_values %}#}
{#                                    {{ val|floatformat:2 }} {{ item.currency }}#}
{#                                    {% if not forloop.last %}, {% endif %}#}
{#                                {% endfor %}#}
{#                            {% endwith %}#}
{#                        </td>#}
{#                    </tr>#}
{#                    <tr>#}
{#                        <th>–ü—Ä–æ–≥–Ω–æ–∑:</th>#}
{#                        <td class="forecast-value">#}
{#                            {{ item.forecast|floatformat:2 }} {{ item.currency }}#}
{#                        </td>#}
{#                    </tr>#}
{#                </table>#}
{#            </div>#}
{#        </div>#}
{##}
{#        <div class="recommendation">#}
{#            <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:</strong>#}
{#            {{ item.insight }}#}
{#        </div>#}
{#    </div>#}
{#    {% endfor %}#}
{#</div>#}
{##}
{#<style>#}
{#    .currency-badge {#}
{#        background: #e2e8f0;#}
{#        padding: 2px 8px;#}
{#        border-radius: 12px;#}
{#        font-size: 12px;#}
{#        font-weight: 500;#}
{#        margin-left: 8px;#}
{#    }#}
{##}
{#    .forecast-value {#}
{#        font-weight: 600;#}
{#        color: #2b6cb0;#}
{#    }#}
{##}
{#    .finance-content {#}
{#        padding: 20px;#}
{#        max-width: 1000px;#}
{#        margin: 0 auto;#}
{#        font-family: 'Inter', sans-serif;#}
{#    }#}
{##}
{#    .finance-title {#}
{#        font-size: 24px;#}
{#        font-weight: 600;#}
{#        color: #2d3748;#}
{#        margin-bottom: 20px;#}
{#        padding-bottom: 10px;#}
{#        border-bottom: 1px solid #e2e8f0;#}
{#    }#}
{##}
{#    .section-title {#}
{#        font-size: 20px;#}
{#        font-weight: 600;#}
{#        color: #2d3748;#}
{#        margin: 25px 0 15px;#}
{#    }#}
{##}
{#    .category-card {#}
{#        background: white;#}
{#        border-radius: 8px;#}
{#        padding: 0;#}
{#        margin-bottom: 25px;#}
{#        box-shadow: 0 2px 4px rgba(0,0,0,0.05);#}
{#        border: 1px solid #edf2f7;#}
{#    }#}
{##}
{#    .category-header {#}
{#        padding: 15px;#}
{#        border-bottom: 1px solid #edf2f7;#}
{#        font-weight: 600;#}
{#        color: #2d3748;#}
{#        display: flex;#}
{#        align-items: center;#}
{#    }#}
{##}
{#    .category-content {#}
{#        display: flex;#}
{#        padding: 15px;#}
{#    }#}
{##}
{#    @media (max-width: 768px) {#}
{#        .category-content {#}
{#            flex-direction: column;#}
{#        }#}
{#    }#}
{##}
{#    .chart-container {#}
{#        flex: 2;#}
{#        min-height: 200px;#}
{#        position: relative;#}
{#    }#}
{##}
{#    .data-table {#}
{#        flex: 1;#}
{#        margin-left: 20px;#}
{#    }#}
{##}
{#    .data-table table {#}
{#        width: 100%;#}
{#        border-collapse: collapse;#}
{#    }#}
{##}
{#    .data-table th, .data-table td {#}
{#        padding: 8px 12px;#}
{#        text-align: left;#}
{#        border-bottom: 1px solid #edf2f7;#}
{#    }#}
{##}
{#    .data-table th {#}
{#        font-weight: 500;#}
{#        color: #4a5568;#}
{#        white-space: nowrap;#}
{#    }#}
{##}
{#    .recommendation {#}
{#        padding: 15px;#}
{#        background: #f8fafc;#}
{#        border-top: 1px solid #edf2f7;#}
{#        font-size: 14px;#}
{#        color: #4a5568;#}
{#    }#}
{#</style>#}
{##}
{#<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>#}
{#<script>#}
{#document.addEventListener('DOMContentLoaded', function() {#}
{#    {% for item in trend_data %}#}
{#    try {#}
{#        const ctx = document.getElementById('chart-{{ forloop.counter }}');#}
{#        if (!ctx) return;#}
{##}
{#        new Chart(ctx, {#}
{#            type: 'line',#}
{#            data: {#}
{#                labels: JSON.parse('{{ item.months_json|escapejs }}'),#}
{#                datasets: [{#}
{#                    label: '{{ item.category }} ({{ item.currency }})',#}
{#                    data: JSON.parse('{{ item.values_json|escapejs }}'),#}
{#                    borderColor: '#3182ce',#}
{#                    backgroundColor: 'rgba(49, 130, 206, 0.1)',#}
{#                    borderWidth: 2,#}
{#                    tension: 0.3,#}
{#                    fill: true,#}
{#                    pointRadius: 4#}
{#                }]#}
{#            },#}
{#            options: {#}
{#                responsive: true,#}
{#                maintainAspectRatio: false,#}
{#                plugins: {#}
{#                    legend: {#}
{#                        display: false#}
{#                    },#}
{#                    tooltip: {#}
{#                        callbacks: {#}
{#                            label: function(context) {#}
{#                                return context.dataset.label + ': ' + context.raw.toFixed(2);#}
{#                            }#}
{#                        }#}
{#                    }#}
{#                }#}
{#            }#}
{#        });#}
{#    } catch (error) {#}
{#        console.error('Error creating chart:', error);#}
{#    }#}
{#    {% endfor %}#}
{#});#}
{#</script>#}
{#{% endblock %}#}



{% extends 'main/layout.html' %}
{% load static %}

{% block content %}
<div class="finance-content">
    <h1 class="finance-title">–ê–Ω–∞–ª—ñ–∑ –≤–∏—Ç—Ä–∞—Ç —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</h1>

{#    <!-- –¢—Ä–µ–Ω–¥–∏ –≤–∏—Ç—Ä–∞—Ç -->#}
{#    <h3 class="section-title">–¢—Ä–µ–Ω–¥–∏ –≤–∏—Ç—Ä–∞—Ç –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏</h3>#}

    {% for item in trend_data %}
    <div class="category-card">
        <div class="category-header">
            {{ item.category }}
            <span class="currency-badge">{{ item.currency }}</span>
        </div>

        <div class="category-content">
            <div class="chart-container">
                <canvas id="chart-{{ forloop.counter }}"></canvas>
            </div>

            <div class="data-table">
                <table>
                    <tr>
                        <th>–û—Å—Ç–∞–Ω–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:</th>
                        <td class="values-list">
                            {% with last_values=item.values|slice:"-3:" %}
                                {% for val in last_values %}
                                    <span class="value-item">{{ val|floatformat:2 }}</span>
                                {% endfor %}
                            {% endwith %}
                        </td>
                    </tr>
                    <tr>
                        <th>–ü—Ä–æ–≥–Ω–æ–∑:</th>
                        <td class="forecast-value">
                            {{ item.forecast|floatformat:2 }}
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="recommendation">
            <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:</strong>
            {{ item.insight }}
        </div>
    </div>
    {% endfor %}
</div>

<style>
    .currency-badge {
        background: #e2e8f0;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
        margin-left: 8px;
    }

    .forecast-value {
        font-weight: 600;
        color: #2b6cb0;
    }

    .finance-content {
        padding: 20px;
        max-width: 1000px;
        margin: 0 auto;
        font-family: 'Inter', sans-serif;
    }

    .finance-title {
        font-size: 24px;
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid #e2e8f0;
    }

    .section-title {
        font-size: 20px;
        font-weight: 600;
        color: #2d3748;
        margin: 25px 0 15px;
    }

    .category-card {
        background: white;
        border-radius: 8px;
        padding: 0;
        margin-bottom: 25px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        border: 1px solid #edf2f7;
    }

    .category-header {
        padding: 15px;
        border-bottom: 1px solid #edf2f7;
        font-weight: 600;
        color: #2d3748;
        display: flex;
        align-items: center;
    }

    .category-content {
        display: flex;
        padding: 15px;
    }

    @media (max-width: 768px) {
        .category-content {
            flex-direction: column;
        }
    }

    .chart-container {
        flex: 2;
        min-height: 200px;
        position: relative;
    }

    .data-table {
        flex: 1;
        margin-left: 20px;
    }

    .data-table table {
        width: 100%;
        border-collapse: collapse;
    }

    .data-table th, .data-table td {
        padding: 8px 12px;
        text-align: left;
        border-bottom: 1px solid #edf2f7;
    }

    .data-table th {
        font-weight: 500;
        color: #4a5568;
        white-space: nowrap;
    }

    .recommendation {
        padding: 15px;
        background: #f8fafc;
        border-top: 1px solid #edf2f7;
        font-size: 14px;
        color: #4a5568;
    }

    .values-list {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
    }

    .value-item {
        display: inline-block;
        min-width: 60px;
    }

</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    {% for item in trend_data %}
    try {
        const ctx = document.getElementById('chart-{{ forloop.counter }}');
        if (!ctx) return;

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: JSON.parse('{{ item.months_json|escapejs }}'),
                datasets: [{
                    label: '{{ item.category }}',
                    data: JSON.parse('{{ item.values_json|escapejs }}'),
                    borderColor: '#3182ce',
                    backgroundColor: 'rgba(49, 130, 206, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: true,
                    pointRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': ' + context.raw.toFixed(2);
                            }
                        }
                    }
                }
            }
        });
    } catch (error) {
        console.error('Error creating chart:', error);
    }
    {% endfor %}
});
</script>
{% endblock %}